# Console Output Formatting
<!-- NOTE: This document describes the standard console output format produced by the test runner. -->
<!-- More advanced, structured output formats (like JUnit, HTML, JSON) are handled by the Reporting system (see docs/api/reporting.md). -->

## Overview

When tests are run using `scripts/runner.lua`, Firmo provides basic feedback directly to the console. This output indicates the status of each test (PASS, FAIL, SKIP, PENDING) and includes color coding to improve readability.

Currently, the console output format is largely fixed within the test runner (`scripts/runner.lua`) and offers limited customization options through programmatic APIs or command-line flags.

## Standard Console Output

The typical console output displays the status and name of each test:

```text
PASS Test Name One
PASS Another Test
FAIL Test That Failed - Assertion failed: Expected 1 but got 2
SKIP Skipped Test - Reason for skipping
PENDING Pending Test - Test not yet implemented
```

- **PASS**: Indicates a test completed successfully. Shown in green.
- **FAIL**: Indicates a test failed due to an assertion failure or an unexpected error during execution. Shown in red, often followed by an error message.
- **SKIP**: Indicates a test was intentionally skipped (e.g., using `xit` or `xdescribe`). Shown in yellow, potentially with a reason.
- **PENDING**: Indicates a test was marked as pending using `firmo.pending()`. Shown in yellow.

## Configuration

The primary way to influence console output is through command-line flags passed to the runner:

- `--verbose` (`-v`): Enables more detailed logging output from the runner and framework modules, which can appear interleaved with test results.
- `--coverage-debug` (`-cd`): Enables debug output specifically from the coverage module.

Colorization is generally enabled by default but might be automatically disabled in environments that don't support ANSI codes or if the `NO_COLOR` environment variable is set (behavior may vary by terminal). There is currently no dedicated flag or API function to reliably force color off/on.

Indentation, verbosity levels (compact, dot, summary), and specific content display are **not** currently configurable for the standard console output.

## Showing Stack Traces

Stack traces are generally shown for **errors during test file execution** (e.g., syntax errors, errors in `describe` or `before`/`after` blocks) caught by the runner's top-level error handling.

Stack traces for assertion failures within `it` blocks are usually handled by the assertion library and may be summarized in the failure message rather than displayed as a full trace by default.

```text
FAIL Test that will fail - Assertion failed: Expected true but got false
  stack traceback:
    test.lua:10: in function <test.lua:9>
    ... internal firmo stack ...
```

The visibility and format of stack traces depend more on the error handling and assertion mechanisms than on specific output formatting options.

## Command Line Integration

### `--format=<format>`

**Important:** The `--format` command-line flag specifies the format for **file-based reports** generated by the `lib/reporting` module, such as JUnit XML or HTML coverage reports. It **does not** change the style of the standard console output (e.g., it does not enable "dot" or "compact" mode on the console).

```bash
# Generate a JUnit XML report file (does NOT change console output)
lua firmo.lua --format=junit tests/

# Generate an HTML coverage report (does NOT change console output)
lua firmo.lua --coverage --format=html tests/
```

See `docs/api/reporting.md` for details on available reporting formats.

## Best Practices

1.  **Rely on Reporting for Structured Output**: Use file-based reporting formats (`--format=junit`, `--format=json`) for CI systems or detailed analysis, as the console output is basic.
2.  **Use Verbose Mode for Debugging**: Use the `--verbose` flag when debugging test runs to see more internal logging from the framework.
3.  **Consider Environment**: Be aware that color output might not work correctly in all terminal environments or when redirecting output to files. Check for `NO_COLOR` environment variable support if needed.
